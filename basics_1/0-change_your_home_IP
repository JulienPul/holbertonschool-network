#!/usr/bin/env bash
# Put 127.0.0.2 localhost and 8.8.8.8 facebook.com at the top of /etc/hosts
set -euo pipefail; IFS=$'\n\t'

tmp="$(mktemp)"
# retirer d’éventuelles anciennes lignes
grep -Ev '^(127\.0\.0\.2[[:space:]]+localhost|8\.8\.8\.8[[:space:]]+facebook\.com)([[:space:]]|$)' /etc/hosts > "$tmp"
# préfixer proprement
{ printf '127.0.0.2 localhost\n8.8.8.8 facebook.com\n'; cat "$tmp"; } > "${tmp}.new"
install -m 0644 "${tmp}.new" /etc/hosts
rm -f "$tmp" "${tmp}.new"
